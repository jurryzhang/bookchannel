<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <title>{$bookname}-----参考文案</title>
    <link href="//cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/toastr.js/2.1.3/toastr.min.css" rel="stylesheet">
    <script src="Http://cdn.bootcss.com/jquery/1.12.4/jquery.js"></script>
    <script src="http://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/Public/js/clipboard.min.js"></script>
    <script src="https://cdn.bootcss.com/layer/3.0.1/layer.min.js"></script>



    <link rel="stylesheet" type="text/css" href="http://new.emeixs.com/Public/wxeditor/css/wechat.css" />
    <style type="text/css">
        .rich_media_content p{
            word-wrap: break-word;
            font-size: 17px;
            line-height: 40px;
            text-align: left;
        }
        .alertBox{display:none;width:100%;height:100%;position:relative;top:0;left:0;z-index:1;}
        .alertBox .mark{
            width:100%;height:100%;
            position:fixed;top:0;left:0;
            background:#000;opacity:0.3;
        }
        .alertBox .alert{
            display:none;
            width: 700px;height:498px;
            background:#FFF;
            position:fixed;top:50%;left:50%;
            z-index:9;
        }
        .alertBox .alt-header{
            cursor:move;
            padding:4px 17px;
            height:7%;line-height:20px;
            font-size:17px;
            border-bottom: 1px solid #CCCCCC;
        }
        .alertBox .alt-header .icon{
            float:right;
            cursor:pointer;
            font-style:normal;
        }
        .alertBox .alt-body{
            padding:10px 26px;
        }
        .alertBox .alt-body tr td{
            padding:8px 20px;
        }
        .alertBox .alt-footer{
            text-align: right;
            margin-right: 10px;
            border-top: 1px solid #CCCCCC;
        }
        .dropdown-menu{
            height:auto;
            max-height: 400px;
            overflow-x: hidden;
        }
        .dropdown a{
            border-bottom:1px solid #c0c0c0;
        }
    </style>
</head>
<body id="activity-detail" class="zh_CN sougou_body">

<div class="alertBox">
    <!--弹框幕布遮罩层-->
    <div class="mark"></div>
    <!--弹出窗口-->
    <form method="post" id="mform" action="">
        <div class="alert zoomIn">
            <div class="alt-header">生成推广链接<i class="fa fa-close icon"></i></div>
            <div class="alt-body">
                <table>
                    <tr>
                        <td>入口页面</td>
                        <td>小说阅读页</td>
                    </tr>
                    <tr>
                        <td>渠道名称</td>
                        <td>
                            <input type="text" value="" name="ptname" id='ptname' placeholder="请填写渠道名称" class="form-control" style="width: 350px; display: inline-block" />
                            <span id="err_ptname" style="color: #F00;"></span>
                        </td>
                    </tr>
                    <tr>
                        <td>渠道成本</td>
                        <td>
                            <input type="text" value="" name="ptcost" id='ptcost' placeholder="请填写渠道成本:数字" class="form-control" style="width: 350px; display: inline-block" />
                            <span id="err_ptcost" style="color: #F00;"></span>
                        </td>
                    </tr>
                    <tr>
                        <td>
                        引导关注的章节数:
                        <p style="font-size:12px;color:red">(填几就是第几章要关注公众号)</p>
                        </td>
                        <td>
                            <input type="text" value="10" name="readchaptercount"  id='readchaptercount' class="input-sm" onblur="if(this.value==''){this.value=10}" placeholder="10"/>
                            <p style="color: #F00;">不填默认为10</p>
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><img src="{$bookPic}" width="70px"></td>
                    </tr>
                    <tr>
                        <td>阅读原文章节</td>
                        <td><b>{$lastChapter['chaptername']}</b></td>
                    </tr>
                </table>
            </div>
            <div class="alt-footer">
                <button class="btn btn-primary" style="margin-top: 10px" title="" type="submit">
                    生成链接
                </button>
            </div>
        </div>
        <input type="hidden" name="id" value="{$id}"/>
        <input type="hidden" name="rchapterid" value="{$rchapterid}"/>
        <input type="hidden" name="rchapter" value="{$lastChapter['chaptername']}"/>
		<input type="hidden" name="chapterorder" value="{$lastChapter['chapterorder']}"/>
        <input type="hidden" name="num" value="{$num}"/>
        <input type="hidden" name="count" value="{$count}"/>
        <input type="hidden" name="fcount" value="{$fcount}"/>
        <input type="hidden" name="titleid" value="{$title['id']}"/>
        <input type="hidden" name="picid" value="{$pic['id']}"/>
    </form>
</div>

<div id="js_article" class="rich_media">
    <div class="rich_media_inner">
        <div id="page-content">
            <div id="img-content" class="rich_media_area_primary">
                <h2 style="border-bottom: 1px solid #e7e7eb;padding-bottom: 10px;" class="rich_media_title" id="title"> {$titleStr} </h2>
                <div class="rich_media_content " id="content">
                    <img style="width: 100%;margin-bottom: 10px;" id="pic" src="{$picStr}" />
                    {$bookStr}
                    {$footer}
                </div>
            </div>
        </div>
    </div>


    <if condition="$Think.cookie.uid gt 0">
        <if condition="$ptid neq 0">
            <div class="input-group" style="margin-bottom: 100px;margin-top: -30px;">
                <span class="input-group-addon">微信原文链接</span>
                <input id="docurl" readonly="" data-clipboard-target="#docurl" style="background:white" class="form-control" value="{$ptlink}" onclick="this.select()" type="text">
                <span class="input-group-btn">
                    <button type="button" id="copy" data-clipboard-target="#docurl" class="btn btn-default"><i class="fa fa-copy"></i> 复制</button>
                </span>
            </div>
        </if>
    </if>

    <if condition="($Think.cookie.uid gt 0) AND ($Think.cookie.pid eq 0)">
        <input id="firstdocurl" readonly="" data-clipboard-target="#firstdocurl" style="background:white;color:white;border:none;" class="form-control" value="{$firstDocUrl}" onclick="this.select()" type="text">
    </if>

</div>

<!--<button type="button" id="WenanUrl" name="wenanUrl" style="background:#fff;border:0px;color:#fff">{$wenanUrl}</button>-->

<div class="input-group" style="width: 180px;box-shadow: rgba(30, 30, 30, 0.027451) 2px 4px 16px;
        border: 1px solid rgb(222, 222, 222);background: #eee;position: fixed;top: 120px;right: 100px;opacity: 0.8;">
    <div style="font-size: 15px;width:180px;height:55px;margin:0px 0px;text-align:center;padding-top: 15px;background: #666;color: #FFFFff">（点击按钮可以复制）</div>
    <button type="button" id="copytitle" data-clipboard-target="#title" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-success"><i class="fa fa-copy"></i> 文案标题</button><br/>
    <button type="button" id="copycontent" data-clipboard-target="#content" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-success"><i class="fa fa-copy"></i> 文案内容</button><br/>
    <if condition="$Think.cookie.uid gt 0">
        <if condition="$Think.cookie.pid eq 0">
            <button type="button" id="copydocurlF" data-clipboard-target="#firstdocurl" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-success"><i class="fa fa-copy"></i> 复制首章链接</button>
        </if>
        <if condition="$ptid eq 0">
            <button type="button"  data-clipboard-target="#docurl" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-warning mkdocurl"><i class="fa fa-copy"></i> 生成原文链接</button>
            <else/>
            <button type="button" id="copydocurl" data-clipboard-target="#docurl" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-success"><i class="fa fa-copy"></i> 复制原文链接</button>
        </if>
    </if>
    <!--<if condition="$Think.cookie.uid gt 0">
        <button type="button" id="copydocurl" data-clipboard-target="#docurl" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-success"><i class="fa fa-copy"></i> 原文链接</button>
        <button type="button" id="copyWenanUrl" data-clipboard-target="#WenanUrl" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-warning"><i class="fa fa-copy"></i> 文案链接</button>
        <if condition="$Think.cookie.pid eq 0">
            <button type="button" id="copydocurlF" data-clipboard-target="#firstdocurl" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-warning"><i class="fa fa-copy"></i> 首章链接</button>
        </if>
        <button type="button" id="refresh" style="width: 90%;margin: 8px;font-size: 15px;" class="btn btn-sm btn-warning"><i class="fa fa-refresh"></i> 刷新</button>
    </if>-->
</div>
<nav class="navbar navbar-default navbar-fixed-bottom">
  <div class="container">
      <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        
        
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="fa fa-header"></i>文案标题 <span class="caret"></span></a>
          <ul class="dropdown-menu">
          <foreach name="titles" item="vt">
            <li><a href="#"  onclick="changeTitle({$vt.id},'{$vt.title}')">{$vt.title}</a></li>
          </foreach>  
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><i class="fa fa-image"></i>文案封面 <span class="caret"></span></a>
          <ul class="dropdown-menu" >
          <foreach name="pics" item="vp">
            <li><a href="#" onclick="changePic({$vp.id},'{$vp.pic}')"><img style="max-width:200px;max-height:40px;" src="{$vp.pic}"/></a></li>
            </foreach>
          </ul>
        </li>
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">正文模板 <span class="caret"></span></a>
          <ul class="dropdown-menu" >
          <foreach name="conts" item="vc">
            <li><a href="#" onclick="changeCont({$vc.id})"><img style="max-width:200px;max-height:40px;" src="{$vc.pic}"/></a></li>
            </foreach>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">引导关注模板 <span class="caret"></span></a>
          <ul class="dropdown-menu" >
          <foreach name="foucses" item="vf">
            <li><a href="#foot-foucs" onclick="changeFoucs({$vf.id})"><img style="max-width:200px;max-height:40px;" src="{$vf.pic}"/></a></li>
            </foreach>
          </ul>
        </li>
      </ul>
    <div class="navbar-form navbar-right">
    <span data-bind="visible: is_novel_online">
      <button type="button"  data-clipboard-target="#docurl"  class="btn btn-primary btn-warning mkdocurl"><i class="fa fa-copy"></i> 生成原文链接</button>
      </span>
      </div>
    </div><!-- /.navbar-collapse -->
  </div>
</nav>
<script>
    var clipboard = new Clipboard('#copy');
    clipboard.on('success', function (e) {
        layer.tips('复制连接成功','#docurl', {
            tips: [1, '#3DA742'],
            time: 4000
        });
    });

    var clipboard = new Clipboard('#docurl');
    clipboard.on('success', function (e) {
        layer.tips('复制连接成功','#docurl', {
            tips: [1, '#3DA742'],
            time: 4000
        });
    });

    var clipboard = new Clipboard('#copytitle');
    clipboard.on('success', function (e) {
        layer.alert('复制标题成功!可以直接粘贴使用!');
    });

    var clipboard = new Clipboard('#copycontent');
    clipboard.on('success', function (e) {
        layer.alert('复制文案内容成功!可以直接粘贴使用!');
    });

    var clipboard = new Clipboard('#copydocurl');
     clipboard.on('success', function (e) {
     layer.alert('复制原文链接成功!可以直接粘贴使用!');
     });

    var clipboard = new Clipboard('#copyWenanUrl');
    clipboard.on('success', function (e) {
        layer.alert('复制文案链接成功!可以直接粘贴使用!');
    });
    /*首章链接 daisy*/
    var clipboard = new Clipboard('#copyF');
    clipboard.on('success', function (e) {
        layer.tips('复制连接成功','#firstdocurl', {
            tips: [1, '#3DA742'],
            time: 4000
        });
    });
    var clipboard = new Clipboard('#firstdocurl');
    clipboard.on('success', function (e) {
        layer.tips('复制连接成功','#firstdocurl', {
            tips: [1, '#3DA742'],
            time: 4000
        });
    });
    var clipboard = new Clipboard('#copydocurlF');
    clipboard.on('success', function (e) {
        layer.alert('复制链接成功!可以直接粘贴使用!');
    });
    $(document).ready(function() {
        var docH = $(document).height();//整个文档的高度
        $('.mkdocurl').click(function (even) {
            even.preventDefault();
            //弹出窗口居中
            var alt_T = $(window).height() / 2 - $('.alert').height() / 4*3;
            var alt_L = $(window).width() / 2 - $('.alert').width() / 2;
            $('.alertBox').fadeIn().find('.mark').height(docH);
            $('.alert').css({top: alt_T, left: alt_L}).addClass('animated').show();
        });
        //点击X关闭整个弹框
        $('.alertBox .icon').click(function(){
            $('.alertBox').fadeOut();
        });
    });

//换标题
function changeTitle(id,str){
    var title = '<h2 style="border-bottom: 1px solid #e7e7eb;padding-bottom: 10px;" class="rich_media_title" id="title">'+str+'</h2>';
    $('#title').remove();
    $('#content').before(title);
    $("#mform > input[name='titleid']").val(id);
    
}

//换图片
function changePic(id,src){
    var pic = $('#pic');
    pic.attr("src",src);

    $("#mform > input[name='picid']").val(id);

    
}
//换正文模板
function changeCont(id){
    path = window.location.pathname;
    url = "__CONTROLLER__/changeModel";
    postData = {'contid':id,'path':path};
    $.post(url,postData,function(result){
        if(result.status==1){
            
            $('.chap-cont').remove();
            $('#pic').after(result.data);
            $("#mform > input[name='count']").val(id);
        }
    },'json');
}
//换引导模板

function changeFoucs(id){
    path = window.location.pathname;
    url = "__CONTROLLER__/changeModel";
    postData = {'foucsid':id,'path':path};
    $.post(url,postData,function(result){
        if(result.status==1){
            //alert(result.data);
            $('#foot-foucs').remove();
            $('.chap-cont:last').after(result.data);
            $("#mform > input[name='fcount']").val(id);
        }
    },'json');
}
</script>

</body>
</html>